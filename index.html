<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="./assets/img/icons/logo.png">
    <link rel="stylesheet" href="./assets/css/styles.css">
    <link rel="manifest" href="manifest.webmanifest">
    <title>Veterra</title>
</head>
    <body>
        <script>
            function detectDevice() {
                const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                if (isMobile) {
                    document.body.innerHTML = `
                        <div style="text-align: center;">
                            <h1>Veterra</h1>
                            <button id="installButton" style="padding: 10px 20px; font-size: 16px; cursor: pointer; display: none;">
                                Installer l'application
                            </button>

                            <script>
                                let deferredPrompt;

                                window.addEventListener("beforeinstallprompt", (event) => {
                                    event.preventDefault();
                                    deferredPrompt = event;
                                    document.getElementById("installButton").style.display = "block";
                                });

                                document.getElementById("installButton").addEventListener("click", async () => {
                                    if (deferredPrompt) {
                                        deferredPrompt.prompt();
                                        const { outcome } = await deferredPrompt.userChoice;
                                        if (outcome === "accepted") {
                                            console.log("L'utilisateur a installé l'application");
                                        }
                                        deferredPrompt = null;
                                    }
                                });

                                window.addEventListener("appinstalled", () => {
                                    console.log("L'application est installée");
                                    document.getElementById("installButton").style.display = "none";
                                });
                            </script>
                            <img src="./assets/img/icons/logo.png" alt="Logo" style="width: 100px; height: auto;">
                            <p>Cette application est optimisée pour les ordinateurs de bureau.</p>
                            <p>Veuillez utiliser un ordinateur pour une meilleure expérience.</p>
                        <div style="text-align: center; margin-top: 20%;">
                            <p>L'application est en cours de construction pour les appareils mobiles.</p>
                            <button onclick="window.location.href='/main.html'" style="padding: 10px 20px; font-size: 16px;">Ouvrir quand même</button>
                            <button onclick="window.location.href='/widget.html'" style="padding: 10px 20px; font-size: 16px;">Page de test des widget</button>                        
                            </div>
                    `;
                } else {
                    window.location.href = '/main.html';
                }
            }

            detectDevice();
        </script>
    </body>
</html>